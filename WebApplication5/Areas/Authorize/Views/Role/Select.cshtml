@{
    //-------------------------------------------------------------------
    //【AUTH_ROLE】Select
    //-------------------------------------------------------------------

    Layout = "~/Views/Shared/_GridLayout.cshtml";
}

@section PageCommandBefore{
    <div id="searchPanel"></div>
}
@section Buttons{
   <a class="easyui-linkbutton" data-options="iconCls:'icon-save',plain:true" onclick="save();">确定</a>
   <a class="easyui-linkbutton" data-options="iconCls:'icon-reload',plain:true" onclick="refresh();">刷新</a>
}

<table id="AUTH_ROLE_Grid"></table>

<script>
    var me = this;
    var mygrid = $('#AUTH_ROLE_Grid');
    var mygridConfig = {};
    var urlParams = commonhelper.getUrlParams();

    $(document).ready(function () {
        initGrid();
        initSearchPanel();
    });

    function initGrid() {
	    var filters = me.filters || [];

		var opts={
            url:window.applicationPath +'/Authorize/Role/GetPaged',
            border: true,
            fit:true,
            pagination: true,
            rownumbers: true,
		    singleSelect:true,
			striped:true,
			idField:'ID',
						columns:[[
			    { field: 'ck', checkbox: true},
			                { field: 'NAME', title: "角色名称",width:166 },
			                { field: 'DESCRIPTION', title: "角色描述",width:467 }
						]],
            queryParams: {
                filters: JSON.stringify(me.filters),
				orders:'SORTNUMBER ASC'
            }
	    };

        

				mygrid.datagrid(opts);
		        mygrid.queryParams = {
            filters: JSON.stringify(filters),
			orders:'SORTNUMBER ASC'
        }
    }

    function initSearchPanel() {
        $("#searchPanel").searchpanel({
            items: [
					    {text:'角色名称',value:'NAME'}
		     			],
            parentGrid: mygrid
        });
    }

    function save() {
	    if(urlParams.singleSelect){
            commonhelper.SingleSelectGrid(mygrid, function (id, row) {
		      if(window.selectCallback){
			     window.selectCallback([id],[row]);
			  }
            });
		}
		else{
		    commonhelper.MultiSelectGrid(mygrid, function (ids, rows) {
		      if(window.selectCallback){
			     window.selectCallback(ids,rows);
			  }
            });
		}
    }
    function refresh() {
        mygrid.datagrid('clearSelections');
        if (mygrid.queryParams) {
            mygrid.datagrid('load', mygrid.queryParams);
        }
        else {
            mygrid.datagrid('reload');
        }
    }
</script>
