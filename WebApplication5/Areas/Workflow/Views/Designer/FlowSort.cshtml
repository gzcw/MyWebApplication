@*-------------------------------------------------------------------
    【FLOWSORT】Grid
    -------------------------------------------------------------------*@
@{
    Layout = "~/Views/Shared/_FormLayout.cshtml";
}
<style>
    form {
        width: 400px;
        margin-left: auto;
        margin-right: auto;
    }

    input {
        width: 200px;
        height: 20px;
    }
</style>
<form id="FLOWSORT_form" method="post" class="myform">
    <input type="hidden" name="NO" />

    <table cellpadding="0" cellspacing="0" style="width: 400px" class="mytable">
        <tr><th>名称：</th><td><input class='easyui-textbox' name='NAME' /></td></tr>
    </table>
</form>

<script>
    var me = this;
    var myform = $('#FLOWSORT_form');

    initForm();
    $(document).ready(function () {

        if (me.formId) {
            $.messager.progress();
            loadForm();
        }
        else if (me.defaultValues) {
            myform.form('load', me.defaultValues);
        }

        if (me.Personalize && typeof (me.Personalize) == "function") {
            Personalize();
        }
    });

    //初始化表单
    function initForm() {
        myform.form({
            onLoadSuccess: function (data) {
                $.messager.progress('close');
            }
        });
    }

    //加载表单
    function loadForm() {
        myform.form('load', '@Url.Action("LoadForm","FLOWSORT")/' + me.formId);
    }

    //保存
    function save() {
        $.messager.progress();
        myform.form('submit', {
            url: '@Url.Action("SaveFLOWSORT","FLOWSORT")',
            showMsg: false,
            onSubmit: function () {
                var isValid = myform.form('validate');
                flag = isValid;
                if (!isValid) {
                    $.messager.progress('close');
                    $.messager.alert("提示", "表单未正确填写，请检查");
                }
                return isValid;
            },
            success: function (result) {
                $.messager.progress('close');
                if (result.success) {
                    $.messager.tip(result.msg);
                    if (me.wfTree) {
                        me.wfTree.tree('reload');
                    }
                    me.easyWindow.window('close');
                }
            }
        })
    }
    //重置
    function reset() {
        loadForm();
    }
    //取消
    function cancel() {
        me.easyWindow.window('close');
    }
</script>
