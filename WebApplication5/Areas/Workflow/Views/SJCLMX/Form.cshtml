@*-------------------------------------------------------------------
    【办文材料明细】页面
    ---------------------------------------------------------------------*@
@{
    Layout = "../Shared/_FormLayout.cshtml";
}
<div style="margin-bottom: 10px;">
    <a class="easyui-linkbutton" data-options="iconCls:'icon-save'" style="margin-left: 10px;" onclick="save();">保存</a>
    <a class="easyui-linkbutton" data-options="iconCls:'icon-undo'" onclick="reset();">重置</a>
    <a class="easyui-linkbutton" data-options="iconCls:'icon-remove',permission:0" onclick="cancel();">关闭</a>
</div>

<form id="SJCLMX_form" class="myform" method="post">
    <input type="hidden" name="ID" />
    <input type="hidden" name="SJDID" />
    <input type="hidden" name="DataOrigin" />
    <input type="hidden" name="WJDLID" />
    <input type="hidden" name="YJBS" />
    <input type="hidden" name="BWCLID" />
    <input type="hidden" name="CLLYBS" />
    <fieldset>
        <legend>收件材料信息</legend>
        <table class="mytable">
            <tr>
                <th><span class="x">*</span>材料名称 ：</th>
                <td colspan="3">
                    <input class="easyui-textbox" data-options="required:true,width:594" name="CLMC" />
                </td>
            </tr>
            <tr>
                <th>收件类型：</th>
                <td>
                    <input class="easyui-sjlxcombobox" name="SJLX" />
                </td>
                <th><span class="x">*</span>收件数量：</th>
                <td>
                    <input class="easyui-numberbox" data-options="required:true" name="SJSL" />
                </td>
            </tr>
            <tr>
                <th>材料页数：</th>
                <td>
                    <input class="easyui-numberbox" name="CLYS" />
                </td>
                <th>序号：</th>
                <td>
                    <input class="easyui-numberbox" name="SH" />
                </td>
            </tr>
            <tr>
                <th>备注：</th>
                <td colspan="3">
                    <input name="SHBZ" class="easyui-textbox" data-options="width:592,multiline:true,height:50" />
                </td>
            </tr>
        </table>
    </fieldset>
    <fieldset>
        <legend>附件</legend>
        <table class="easyui-fujiangrid" data-options="height:180"></table>
    </fieldset>
</form>

<script>
    var me = this;
    var myform = $('#SJCLMX_form');

    $(document).ready(function () {
        initForm();
        if (me.formId) {
            $.messager.progress();
            loadForm();
        }
        else if (me.defaultValues) {
            myform.form('load', me.defaultValues);
        }

        if (me.Personalize && typeof (me.Personalize) == "function") {
            Personalize();
        }
    });
    //region个性化代码



    //endregion

    //初始化表单
    function initForm() {
        myform.form({
            onLoadSuccess: function (data) {
                $.messager.progress('close');
            }
            //buttons: [{
            //    iconCls: 'icon-add',
            //    text: '保存',
            //    handler: save
            //}, '-', {
            //    iconCls: 'icon-edit',
            //    text: '重置',
            //    handler: reset
            //}, '-', {
            //    iconCls: 'icon-remove',
            //    text: '取消',
            //    handler: cancel
            //}]
        });
    }

    //加载表单
    function loadForm() {
        myform.form('load', '@Url.Action("LoadForm","SJCLMX")/' + me.formId);
    }

    //保存
    function save() {
        $.messager.progress();
        myform.form('submit', {
            url: '@Url.Action("Save","SJCLMX")',
            onSubmit: function () {
                var isValid = myform.form('validate');
                flag = isValid;
                if (!isValid) {
                    $.messager.progress('close');
                    $.messager.alert("提示", "表单未正确填写，请检查");
                }
                return isValid;
            },
            success: function (result) {
                $.messager.progress('close');
                if (me.parentGrid) {
                    me.parentGrid.datagrid('reload');
                    me.easyWindow.window('close');
                }
            },
            error: function () {

            }
        })
    }
    //重置
    function reset() {
        if (me.formId) {
            loadForm();
            return;
        }
        myform.form('reset');
        if (me.defaultValues) {
            myform.form('load', me.defaultValues);
        }
    }
    //取消
    function cancel() {
        me.easyWindow.window('close');
    }
</script>
